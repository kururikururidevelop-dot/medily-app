# 医療クローズド相談マッチングサービス企画書

# サービス概要
悩んでいる“医療系の疑問・病院選び”の相談を、クローズド（1対1）で回答してくれる人とマッチングするサービス。回答は LINE または X（旧Twitter）を経由して通知され、気軽に答えるだけで協力できる。

# 背景
* 日本では、ネット上の病院レビューや口コミは、患者満足度調査を病院側が主導することが多く、ネガティブな情報が残りにくい構造がある。ある調査機関は、口コミに対して「返信・削除依頼」が可能であることを指摘している。
* 匿名のレビューや口コミは、**実際の体験と乖離する可能性（誇張・偽レビュー）**がある。これを安全・信頼できる情報源とみなすのは難しい、という問題もある。
* 医療広告ガイドラインにより、「特定の病院・医師を優れていると主張する表現」が制限される。患者レビューをそのまま載せるだけでもグレー／NGになる可能性がある。
* 飲食なら食べログ／美容ならホットペッパーみたいに投稿が集まるけど、医療体験は 人がレビューしづらく、投稿率が極端に低い。

# コンセプト
**あなたの経験が、だれかの安心に変わる。**
医療は専門的で不安が多い。でも、医療を実際に利用した人の「生の経験」は、専門知識よりも心を軽くすることがある。質問者は不安を和らげ、回答者は経験を分かちあって人の役に立てる——そんな相互支援プラットフォーム。
質問者側は病院・症状相談の「公開しにくい本音」を安心して共有できる。
回答者側は短時間で人助けでき、自己有用感が高まる。

# サービス名
Medily（メディリー）
  * メディカル＋フレンドリー 

# 質問と回答のパターン
## 質問のパターン
* 質問：質問したい内容をLIFFのフォームで入力する。
* 回答：回答できる選択肢を最大6つ入力する。自由入力or質問テンプレートを選んでから入力する（任意）。
* カテゴリ：関連のある病院相談や症状カテゴリをチェックする（任意）。
* 公開レベル：質問を公開してもいい場合は有効にする。デフォルトは有効。
* 地域：マッチングさせる地域を入力する（必須）。デフォルトはメンバーの地域。
* 性別：マッチングさせる性別を入力する（任意）。デフォルトはメンバーの性別。
* 年齢：マッチングさせる年齢を入力する（任意）。デフォルトはメンバーの生まれ年から範囲を決める。

## 回答のパターン
* 回答：質問に該当する選択肢をチェックする。
* 場所・URL： 質問に該当する場所を地図アプリで指定、またはURLを張り付ける。
* 質問者へ一言：140文字以内の短文で、質問者へ伝えたいニュアンスや体験談を記述する。

# サービスの流れ（UX）
## 新規質問
  ## 質問者
  1. LINEトーク画面から「質問する」ボタンをタップ。
  2. LIFF画面で質問を投稿（質問テンプレートで簡単入力）。
  3. 回答者がマッチングされる。
  4. 回答がLINEのDM経由で届く。
  5. 個別チャットスレッドで追加質問 or 終了。
  6. 【コスト対策】 会話のラリー回数に制限を設ける（例：3往復まで）。
  7. お礼メッセージを送る（回答者に通知）。

  ## 回答者
  1. 質問が LINE に通知される（マルチキャスト）。
  2. 「回答する」をタップし、LIFF画面で回答を入力。
    * 回答形式： 「選択式」＋「場所」＋「URL」＋「短文フリー記述（100〜140文字推奨）」
    * 【NGワード対策】 送信前にAIが診断・誹謗中傷をチェックし、問題があれば修正を促す。
  2. 回答後は感謝メッセージ（グラフィック）が届く。
  3. 自分の貢献が“ビジュアルで蓄積”されていく。

## 質問者と回答者のやり取り
一度回答があった質問については、システムが確立した1対1のチャットスレッドを通じて、質問者と回答者が個別にメッセージをやり取りする。

# 質問者の質問を簡単にする仕組み
質問者の負担を減らすため、質問テンプレートを準備する。
病院相談テンプレ、症状カテゴリテンプレなど。

例：
病院相談：
○○が痛くない検査がいい
料金が安い
清潔
設備が良い など

症状カテゴリ：
腰痛
頭痛
アレルギー
子どもの風邪
心療内科系 など

# 回答者のモチベーション設計（グラフィカル）
❇️ 数値にしない“感謝の可視化システム”
回答数やポイントではなく、
誰かを助けるたびに「木の葉が増える」「星が輝く」「街が育つ」
などのグラフィカルなアニメーションで表現。
例：
最初は「小さな苗」
1回答→葉っぱが1枚増える
10回答→小さな木に
50回答→街ができる
お礼メッセージでキラッと光る演出
自己有用感を刺激し、自然に回答したくなる仕掛け。

# 基本的なアーキテクチャ
本サービスでは、質問者と回答者のプライバシーを完全に保護しつつ、効率的なマッチングを実現するため、**システム（サーバー）が常に仲介役となるアーキテクチャ**を採用する。

## システムの役割と匿名性
* **システムの仲介役:** 質問者と回答者は、互いの LINE ID を知ることはない設計とする。システムが、それぞれのユーザーになり代わってメッセージを転送することで、クローズドな環境を維持します。
* **LINEプラットフォームへの一本化:** 質問・回答・通知のすべてを LINE Messaging API を通じて処理する。

## メッセージングロジック（「一斉通知」から「個別会話」への移行）
質問の投稿から回答者の確定、個別会話への移行は、以下の3段階のロジックで実現する。

| フェーズ | 動作のトリガー | 受信先 | システム動作 |
| :--- | :--- | :--- | :--- |
| **① 初期通知** | 質問投稿 | マッチングされた回答者グループ（例：10人） | LINE Messaging API の **マルチキャスト機能** を利用し、適格な複数の回答者に質問を一斉通知します。 |
| **①' 質問の更新** | 質問者が**回答が来る前**に質問内容を更新 | **初期選定された回答者グループ全体** | 質問者の更新内容は、再びマルチキャスト機能を利用して、最初に選定された回答者グループ全員に**「質問の更新通知」**として送られます。 |
| **② 会話スレッドの確立** | 回答者による「回答する」アクション | 質問者 | 回答者がアクションを起こした際、DBに「質問ID - 回答者ID」の**専用ペア（仮想スレッド）**を作成し、以後の会話経路を確保します。 |
| **③ 個別チャット** | 質問者、または回答者による返信 | **専用ペアの相手** | 一度スレッドが確立されると、以降のメッセージはシステムが仲介役となり、そのペア間でのみ転送されます。（1対1の継続的なやり取り） |

## 質問エスカレーションロジック（カスケード型ブロードキャスト）
初期通知グループから回答が得られない質問を放置せず、解決率を高めるために、通知を次の候補者グループに自動的に拡大する仕組みを導入する。

| フェーズ | 動作のトリガー | システム動作 | 目的と効果 |
| :--- | :--- | :--- | :--- |
| **通知拡大（リトライ）** | **初期通知から6時間など、一定時間が経過**し、**誰も回答していない**場合 | 1. サーバー内のスケジューラが起動し、未回答の質問を特定。2. 条件に合う**次の10名（Bグループ）**を選定し、マルチキャストで通知。3. 既に通知済みのユーザーには**重複して通知しない**ようDBで管理（通知済みIDの記録）。 | 通知対象を自動的に拡大し、**質問の解決率向上**を図る。 |
| **エスカレーションの終了** | 通知拡大を最大3回（合計30名）など**上限回数まで試行**しても回答がない場合 | 質問を「未解決」ステータスとしてDBに記録し、質問者へ「回答者が見つかりませんでした」という通知を送り、スレッドを自動クローズ（期間による自動クローズ）に移行する。 | 無限の通知を防ぎ、**回答者の通知疲労を防止**する。 |

## スレッドのクロージングロジック（滞留防止策）
システムの健全な運用と回答者の負担軽減のため、すべてのチャットスレッドは以下のいずれかのルールで必ずクローズさせる。

| クロージング手段 | トリガー | 目的と効果 |
| :--- | :--- | :--- |
| **A. 質問者による手動終了** | 質問者が会話画面内の「**解決したので終了する**」ボタンをタップ | 質問者の意思を反映した確実な解決（解決率計測に反映）。 |
| **B. ラリー制限による自動終了** | 会話のラリー回数が上限（例：3往復）に達する | LINE Messaging API の Pushメッセージ利用を制限し、**ランニングコストの超過を防ぐ**。 |
| **C. 期間による自動クローズ** | **最終メッセージ送信から48時間（または7日間）が経過** | ユーザーの離脱や放置による**スレッドの滞留・無限化を防止**するセーフティネット。DBの健全性を保つ。 |

# メンバー登録の流れ
## 質問者のメンバー登録
PRサイトで興味を持ってもらい、簡単な質問から初めてもらう。
最初の質問と同時にメンバー登録を行ってもらう。

## 回答者のメンバー登録
PRサイトの公開質問や解決率を見て自分が回答できそうな質問があれば回答してもらう。
最初の回答と同時にメンバー登録を行ってもらう。

## メンバーの登録内容（プロフィール情報）
* プロフィール画像
* メールアドレス
* ニックネーム（必須）
* 性別（任意）
* 生まれ年（任意）
* 住まいの地域（必須）
* 回答可能カテゴリ（任意）

# アカウント連携（対応したいサービス）
## ログイン（OAuth）
LINE

# 開発技術（AI活用含む）
## Webアプリ
Firebase + Next.jss (LIFF（LINE Front-end Framework）用のビュー構築)
  * Next.jsで、LINEアプリ内に埋め込むLIFF（入力フォームやマイページ）を構築する。

## 開発向けAIエージェント
GitHub Copilot Workspace

## AI活用
メッセージフィルタリング： 回答者のフリー記述に対し、LLM（大規模言語モデル）を活用し、**「診断行為」「断定的な治療効果の言及」「誹謗中傷」**などを文脈で自動判定・フィルタリングする。

## ランニングコスト
サービス規模によるが初期は安い。
**Firebase + Vercel の例**
認証：無料（一定枠）
Firestore：1〜3千円/月
Cloud Functions：1〜3千円/月
Hosting：数百円〜千円/月
Vercel：無料〜1,200円/月
合計：月2,000〜7,000円程度
（ユーザー増加に応じて上がる）
LINE Messaging API や X API の連携を使うと
+2,000〜数万円/月まで増える可能性あり。
→ これは通知で工夫可能。

* **LINE Messaging API のコスト対策:**
    * **マルチキャスト（一斉通知）：** 新規質問時の通知に利用するが、契約プランの無料枠内で収まるよう、通知頻度や対象人数を調整する。
    * **チャット転送（個別会話）：** 質問者・回答者間のメッセージ転送は「Pushメッセージ」となり課金対象となるため、**会話のラリー回数に制限を設ける（例：3往復まで）**ことでコスト超過を防ぐ。

# 収益モデル案
**寄付（BuyMeACoffee 的）**
回答者やサービスに対して“ありがとう”の支援。
**質問者の優先枠課金**
回答を早く返してほしい
詳しい人に回答してほしい
などの優先機能。
**サブスク**
「プレミアム相談」を月額化。
**広告（医療推奨情報は慎重に）**
慎重にやれば可能。

ローンチ時は「寄付」か「未来の有料プランの予告」を入れる。

# 機能（MVP）
* 質問投稿（LIFF経由）
* 回答者の自動マッチング（地域 × 症状カテゴリ）
* 1対1チャット（クローズド）
  * 個別チャットのラリー回数制限機能
* プロフィール（匿名）
* 通報ボタン
* 利用規約（誹謗中傷禁止・診断禁止）

# 機能（ローンチ）
* PRサイト
* メンバー登録
* マイページ
* 質問照会
