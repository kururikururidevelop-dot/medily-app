# 画面遷移設計書

## 初期導線

```
[A010: PRサイトTOP]
   ├── 会員登録 → [A020: OAuth選択]
   └── ログイン → [A020: OAuth選択]

[A020: OAuth選択]
   └── 認証成功
         ├── 初回 → [A030: 初回プロフィール登録]
         └── 既存 → [A040: ホーム]

[A030: 初回プロフィール登録]
   └── 登録完了 → [A040: ホーム]
```

---

## ホーム画面（A040）からの遷移

```
[A040: ホーム]
├── 質問する → [B010: 質問投稿]
├── 自分の質問 → [E010: 質問一覧（自分）]
├── 自分の回答 → [E020: 回答一覧（自分）]
├── マイページ → [D010: マイページ]
└── 設定 → [F010: 設定]
```

---

## 質問投稿フロー

### 新規質問・追加質問・逆質問への再質問フロー
```
[B010: 質問投稿]
   ├── 質問タイプ選択
   │   ├── 新規質問選択 → [B010: 質問内容入力]
   │   ├── 追加質問選択 → 過去質問選択ステップ → [B010: 質問内容入力]
   │   └── 逆質問への再質問選択 → 対象回答者選択ステップ → [B010: 質問内容入力]
   ├── 確認 → [B011: 質問投稿確認]
   └── キャンセル → [A040: ホーム]

[B011: 質問投稿確認]
   ├── 投稿 → [B012: 質問投稿完了]
   └── 修正 → [B010: 質問投稿]

[B012: 質問投稿完了]
   └── 完了 → [B020: 質問詳細（質問者）]
```

**補足**
* 新規質問：すべてのマッチング対象回答者へ配信
* 追加質問：新規質問でマッチングした全回答者へ配信
* 逆質問への再質問：逆質問を送信した特定の回答者のみへ配信

---

## 質問閲覧フロー

### 自分の質問

```
[E010: 質問一覧（自分）]
   └── 質問選択 → [B020: 質問詳細（質問者）]
```

### 公開質問

```
[A040: ホーム]
   └── 公開質問選択 → [B022: 質問詳細（公開）]
```

---

## 質問詳細（質問者）

```
[B020: 質問詳細（質問者）]
├── 回答一覧表示
├── 逆質問一覧表示
├── 追加質問送信（システム経由）
├── 質問終了 → 状態更新
└── 戻る → [E010: 質問一覧（自分）]
```

※外部サービス起動は画面外

---

## 回答者動線

### Web画面での表示・確認
```
[B021: 質問詳細（回答者）]
   ├── LINE/X へ遷移（DeepLink）→ 外部アプリで回答実施
   └── 戻る → [A040: ホーム]
```

**補足：回答フロー（LINE/X 内で完結）**
* 回答者は Web で質問を確認後、LINE/X アプリへ遷移
* LINE/X 内で以下の操作を実施：
  * 選択肢回答
  * 場所情報入力
  * URL 添付
  * 定型「一言」送信（可選）
  * 定型「逆質問」送信（可選）
* システムが LINE/X からの送信結果を受信し、Webアプリ上に表示
* Webフォールバック対応：Webで直接送信する場合は C010/C011 へ遷移（管理画面で制御）

---

## マイページ・設定系

```
[D010: マイページ]
├── プロフィール編集 → [D020]
├── 通知設定 → [D030]
├── 設定 → [F010]
└── 戻る → [A040]

[D020: プロフィール編集]
   └── 保存 → [D010]

[D030: 通知設定]
   └── 保存 → [D010]
```

---

## 履歴閲覧

```
[E020: 回答一覧（自分）]
   └── 回答選択 → [B021: 質問詳細（回答者）]
```

---

## 設定系画面

```
[F010: 設定]
├── 利用規約 → [F020]
├── プライバシーポリシー → [F030]
├── 退会 → [F040]
└── 戻る → [A040]

[F020: 利用規約]
   └── 戻る → [F010]

[F030: プライバシーポリシー]
   └── 戻る → [F010]

[F040: 退会]
   ├── 確定 → ログアウト → [A010]
   └── キャンセル → [F010]
```

---

## LINE/X 連携フロー概要

本サービスは質問・回答・逆質問フローを Webアプリ + LINE/X で分散実装しています。

### 質問者の体験フロー
1. **Webアプリ** で質問投稿（新規/追加/逆質問への再質問を選択）
2. **LINE/X** で回答が通知される
3. **Webアプリ** で回答内容を確認・受付終了

### 回答者の体験フロー
1. **LINE/X** で質問が通知される
2. **LINE/X** で回答・一言・逆質問を送信
3. **Webアプリ** でマイページから送信履歴を確認

### 逆質問フロー（3ステップ）
1. **質問者** Webで新規/追加質問投稿
2. **回答者** LINE/Xで回答＋逆質問「一言」送信
3. **質問者** LINE/Xで逆質問を受け取る → 「逆質問に回答する」をタップ → **Webで逆質問への再質問投稿**
4. **回答者** LINE/Xで再質問が通知される → LINE/Xで回答送信
5. **質問者** LINE/Xで最終回答を受け取り → 終了
